[supervisord]
nodaemon=true
user=appuser
logfile=/app/logs/supervisord.log
logfile_maxbytes=50MB
logfile_backups=10
loglevel=info
pidfile=/tmp/supervisord.pid

[program:erp_app]
command=gunicorn --bind 0.0.0.0:8005 --workers 4 --worker-class gevent --worker-connections 1000 --max-requests 1000 --max-requests-jitter 50 --preload --timeout 120 --keep-alive 2 --access-logfile /app/logs/gunicorn_access.log --error-logfile /app/logs/gunicorn_error.log --log-level info --capture-output --enable-stdio-inheritance app:app
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/erp_app_error.log
stdout_logfile=/app/logs/erp_app_output.log
stderr_logfile_maxbytes=10MB
stdout_logfile_maxbytes=10MB
stderr_logfile_backups=5
stdout_logfile_backups=5
environment=FLASK_ENV=production,PYTHONPATH=/app

[program:nginx]
command=nginx -g "daemon off;"
autostart=true
autorestart=true
stderr_logfile=/app/logs/nginx_error.log
stdout_logfile=/app/logs/nginx_output.log
stderr_logfile_maxbytes=10MB
stdout_logfile_maxbytes=10MB

[program:celery_worker]
command=celery -A app.celery worker --loglevel=info --concurrency=2
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/celery_worker_error.log
stdout_logfile=/app/logs/celery_worker_output.log
stderr_logfile_maxbytes=10MB
stdout_logfile_maxbytes=10MB
environment=FLASK_ENV=production,PYTHONPATH=/app

[program:celery_beat]
command=celery -A app.celery beat --loglevel=info --pidfile=/tmp/celerybeat.pid
directory=/app
user=appuser
autostart=true
autorestart=true
stderr_logfile=/app/logs/celery_beat_error.log
stdout_logfile=/app/logs/celery_beat_output.log
stderr_logfile_maxbytes=10MB
stdout_logfile_maxbytes=10MB
environment=FLASK_ENV=production,PYTHONPATH=/app

[unix_http_server]
file=/tmp/supervisor.sock
chmod=0700
chown=appuser:appuser

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[inet_http_server]
port=127.0.0.1:9001
username=admin
password=supervisor_admin_123 