{% extends "base_layout.html" %}

{% block title %}لوحة التحكم - نظام فكرة للإدارة{% endblock %}
{% block page_title %}لوحة التحكم{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/dashboard.css">
{% endblock %}

{% block content %}
<!-- Statistics Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-content">
                <div class="stat-number" id="projectsCount">0</div>
                <div class="stat-label">المشاريع النشطة</div>
            </div>
            <div class="stat-icon primary">
                <i class="fas fa-briefcase"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-content">
                <div class="stat-number" id="employeesCount">0</div>
                <div class="stat-label">الموظفين</div>
            </div>
            <div class="stat-icon success">
                <i class="fas fa-user-tie"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-content">
                <div class="stat-number" id="tasksCount">0</div>
                <div class="stat-label">المهام المعلقة</div>
            </div>
            <div class="stat-icon warning">
                <i class="fas fa-clipboard-check"></i>
            </div>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <div class="stat-content">
                <div class="stat-number" id="clientsCount">0</div>
                <div class="stat-label">العملاء</div>
            </div>
            <div class="stat-icon info">
                <i class="fas fa-users-cog"></i>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="modern-card">
    <div class="card-header">
        <h3 class="mb-0">الإجراءات السريعة</h3>
    </div>
    <div class="card-body">
        <div class="quick-actions">
            <a href="/projects" class="quick-action">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <div class="quick-action-title">مشروع جديد</div>
                <div class="quick-action-desc">إنشاء مشروع</div>
            </a>

            <a href="/employees" class="quick-action">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);">
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="quick-action-title">موظف جديد</div>
                <div class="quick-action-desc">إضافة موظف</div>
            </a>

            <a href="/tasks" class="quick-action">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);">
                    <i class="fas fa-clipboard-list"></i>
                </div>
                <div class="quick-action-title">مهمة جديدة</div>
                <div class="quick-action-desc">إنشاء مهمة</div>
            </a>

            <a href="/clients" class="quick-action">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                    <i class="fas fa-building"></i>
                </div>
                <div class="quick-action-title">عميل جديد</div>
                <div class="quick-action-desc">إضافة عميل</div>
            </a>

            <a href="/reports" class="quick-action">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%);">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="quick-action-title">التقارير</div>
                <div class="quick-action-desc">عرض التقارير</div>
            </a>

            <a href="/settings" class="quick-action">
                <div class="quick-action-icon" style="background: linear-gradient(135deg, #ed64a6 0%, #d53f8c 100%);">
                    <i class="fas fa-sliders-h"></i>
                </div>
                <div class="quick-action-title">الإعدادات</div>
                <div class="quick-action-desc">إعدادات النظام</div>
            </a>
        </div>
    </div>
</div>

<!-- Dashboard Grid -->
<div class="dashboard-grid">
    <!-- Chart Container -->
    <div class="chart-container">
        <div class="chart-header">
            <h4>إحصائيات المشاريع</h4>
        </div>
        <div class="chart-body">
            <canvas id="projectsChart"></canvas>
        </div>
    </div>

    <!-- Activity Feed -->
    <div class="activity-feed">
        <div class="activity-header">
            <h4>النشاطات الأخيرة</h4>
        </div>
        <div class="activity-list" id="activityList">
            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    <i class="fas fa-briefcase"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">مشروع جديد</div>
                    <div class="activity-description">تم إنشاء مشروع "نظام إدارة المحتوى"</div>
                    <div class="activity-time">منذ ساعتين</div>
                </div>
            </div>

            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);">
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">موظف جديد</div>
                    <div class="activity-description">تم إضافة محمد محمد كمطور</div>
                    <div class="activity-time">منذ 4 ساعات</div>
                </div>
            </div>

            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">مهمة مكتملة</div>
                    <div class="activity-description">تم إنجاز مهمة "تصميم واجهة المستخدم"</div>
                    <div class="activity-time">منذ 6 ساعات</div>
                </div>
            </div>

            <div class="activity-item">
                <div class="activity-icon" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);">
                    <i class="fas fa-users-cog"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">عميل جديد</div>
                    <div class="activity-description">تم إضافة شركة التقنية المتقدمة</div>
                    <div class="activity-time">أمس</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- LOCAL CHART RESOURCES FIRST (Essential) -->
<script src="/static/chart-fallback.js"></script>
<!-- System check -->
<script src="/static/system-check.js"></script>
<script>
    window.token = token;
</script>
<script src="/static/dashboard.js"></script>

<!-- CDN Chart.js (Enhancement only) - Load asynchronously -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Try to load Chart.js enhancement
        loadCDNResource('https://cdn.jsdelivr.net/npm/chart.js', 'js',
            'https://unpkg.com/chart.js/dist/chart.min.js');
    });
</script>
{% endblock %}